<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>CS:GO Skrzynka</title>
</head>
<body>
  <h1>Otwórz skrzynkę!</h1>
  <button id="losujBtn">Losuj przedmiot</button>
  <p id="wynik"></p>

  <script src="main.js"></script>

<div id="g_id_onload"
     data-client_id="925130065491-uatooio0iqa35natp6p96i86q67hu4n6.apps.googleusercontent.com"
     data-callback="handleCredentialResponse">
</div>

<div class="g_id_signin" data-type="standard"></div>

<!-- Miejsce na dane użytkownika -->
<div id="user-info" style="display:none; margin-top:10px;">
    <img id="profile-pic" style="width:50px; border-radius:50%;" />
    <p id="username" style="margin:5px 0;"></p>
</div>
<button id="logout-btn" style="display:none; margin-top: 10px;">Wyloguj się</button>



<script src="https://accounts.google.com/gsi/client" async defer></script>
<script>
 function handleCredentialResponse(response) {
    const jwt = response.credential;
    const data = parseJwt(jwt);

    // Pokaż dane użytkownika
    document.getElementById("profile-pic").src = data.picture;
    document.getElementById("username").textContent = data.name;
    document.getElementById("user-info").style.display = 'block';

    // Pokaż przycisk wylogowania
    document.getElementById("logout-btn").style.display = 'inline-block';
}
  function parseJwt(token) {
    const base64Url = token.split('.')[1];
    const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
    const jsonPayload = decodeURIComponent(atob(base64).split('').map(c =>
      '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2)
    ).join(''));

    return JSON.parse(jsonPayload);
  }
  document.getElementById("logout-btn").addEventListener("click", function () {
    // Ukryj dane użytkownika
    document.getElementById("user-info").style.display = 'none';
    document.getElementById("logout-btn").style.display = 'none';
    
    // Ukryj obrazek i nazwę
    document.getElementById("profile-pic").src = '';
    document.getElementById("username").textContent = '';

    // Opcjonalnie: odśwież przycisk logowania (po wylogowaniu)
    google.accounts.id.disableAutoSelect(); // Wymuś nowe logowanie
});

</script>


</body>
</html>
